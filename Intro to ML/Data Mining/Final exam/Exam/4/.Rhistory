getwd()
setwd("E:/DataScience_2019501123/Intro to ML/Data Mining/Final exam/Exam/2")
ar = read.csv("data_apriori.csv", header = TRUE);
ar$TID <- NULL
library(arules)
install.packages("arules")
library(arules)
install.packages("Matrix")
library(arules)
transactions = read.transactions("Items.csv", sep=',', rm.duplicates = TRUE)
rules <- apriori(transactions, parameter = list(sup = 0.03, conf = 0.5,target="rules"))
inspect(sort(basket_rules, by = 'lift')[1:15])
inspect(sort(rules, by = 'lift')[1:15])
itemFrequencyPlot(transactions, topN = 5)
getwd()
setwd("E:/DataScience_2019501123/Intro to ML/Data Mining/Final exam/Exam/3")
install.packages("caret")
library(caret)
library(caret)
library(rpart.plot)
install.packages("rpart.plot")
library(rpart.plot)
install.packages("rpart")
library(rpart.plot)
lenses = read.csv("lenses_data.csv", header = FALSE, col.names = c("1", "2", "3", "4", "5", "Label"))
str(lenses)
summary(lenses)
x = lenses[,1:4]
y = as.factor(lenses$Label)
models = rpart(y~.,x,control=rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=5))
plot(models)
text(models)
rpart.plot(models)
sum(y==predict(models,x,type="class"))/length(y)
#miscalassification error
1-sum(y==predict(models,x,type="class"))/length(y)
models1 = rpart(y~.,x,control=rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7))
plot(models1)
text(models1)
rpart.plot(models1)
#Information Gain
sum(y==predict(models1,x,type="class"))/length(y)
#miscalassification error
1-sum(y==predict(models1,x,type="class"))/length(y)
plot(models)
text(models)
rpart.plot(models)
sum(y==predict(models,x,type="class"))/length(y)
#miscalassification error
1-sum(y==predict(models,x,type="class"))/length(y)
models1 = rpart(y~.,x,control=rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7))
plot(models1)
text(models1)
rpart.plot(models1)
#Information Gain
sum(y==predict(models1,x,type="class"))/length(y)
#miscalassification error
1-sum(y==predict(models1,x,type="class"))/length(y)
setwd("E:/DataScience_2019501123/Intro to ML/Data Mining/Final exam/Exam/3")
liver = read.csv("Liver_data.csv", header = FALSE, col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector"))
getwd()
setwd("E:/DataScience_2019501123/Intro to ML/Data Mining/Final exam/Exam/3")
liver = read.csv("Liver_data.csv", header = FALSE, col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector"))
setwd("E:/DataScience_2019501123/Intro to ML/Data Mining/Final exam/Exam/4")
liver = read.csv("Liver_data.csv", header = FALSE, col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector"))
str(liver_data)
str(Liver_data)
str(liver)
liver$selector <- as.factor(liver$selector)
liver$drinks <- cut(liver$drinks, breaks = c(0, 5,10,15,20),
labels = c('C1', 'C2', "C3", 'C4'), right = FALSE)
liver <- na.omit(liver)
train = subset(liver, liver$selector == 1)
str(train)
test = subset(liver, liver$selector == 2)
str(train)
test = subset(liver, liver$selector == 2)
test = subset(liver, liver$selector == 2)
str(test)
dim(train)
dim(test)
x_train <- subset(train, select = -c(selector, drinks))
x_test <- subset(test, select = -c(selector, drinks))
library(class)
y_train = train[,6, drop = TRUE]
y_test = test[,6, drop = TRUE]
length(train)
length(test)
#k = 1
fit1 = knn(x_train,x_train,y_train,k=1)
1-sum(y_test==fit1)/length(y_test)
#K = 2
fit2 = knn(x_train,x_train,y_train,k=2)
1-sum(y_test==fit2)/length(y_test)
#k = 3
fit3 = knn(x_train,x_train,y_train,k=3)
1-sum(y_test==fit3)/length(y_test)
